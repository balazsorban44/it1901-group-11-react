<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../">
  <title data-ice="title">src/components/Band/index.js | it1901-group-11</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/App.js~App.html">App</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-band">components/Band</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/Band/Concerts.jsx~Concerts.html">Concerts</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/Band/Reviews.jsx~AddReview.html">AddReview</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/Band/TechnicalRequirements.jsx~TechnicalRequirements.html">TechnicalRequirements</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/Band/index.js~Band.html">Band</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Reviews">Reviews</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-bookingboss">components/BookingBoss</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/BookingBoss/Bookings.jsx~Bookings.html">Bookings</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/BookingBoss/index.js~BookingBoss.html">BookingBoss</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Booking">Booking</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-bookingmanager">components/BookingManager</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/BookingManager/BookingStepper.jsx~VerticalLinearStepper.html">VerticalLinearStepper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/BookingManager/NewBooking.jsx~NewBooking.html">NewBooking</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/BookingManager/Search.jsx~Search.html">Search</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/BookingManager/index.js~BookingManager.html">BookingManager</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-login">components/Login</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/Login/index.jsx~Login.html">Login</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-manager">components/Manager</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/Manager/index.js~Manager.html">Manager</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-organizer">components/Organizer</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/Organizer/index.js~Organizer.html">Organizer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-EventInfo">EventInfo</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ScenesList">ScenesList</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-prorganizer">components/PROrganizer</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/PROrganizer/index.js~PROrganizer.html">PROrganizer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-ScenesList">ScenesList</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-servicemanager">components/ServiceManager</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/ServiceManager/index.js~ServiceManager.html">ServiceManager</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Scenes">Scenes</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#components-technician">components/Technician</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/components/Technician/index.js~Technician.html">Technician</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Concerts">Concerts</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#utils">utils</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Icon">Icon</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-InfoSnippet">InfoSnippet</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Loading">Loading</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-NoResult">NoResult</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Rating">Rating</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-Review">Review</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-capitalize">capitalize</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-parseDate">parseDate</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-parseNumber">parseNumber</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-parsePrice">parsePrice</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-parseTime">parseTime</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-muiTheme">muiTheme</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-profiles">profiles</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/components/Band/index.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import React, {Component} from &apos;react&apos;
import {List} from &apos;material-ui/List&apos;
import Divider from &apos;material-ui/Divider&apos;
import FontIcon from &apos;material-ui/FontIcon&apos;
import Chip from &apos;material-ui/Chip&apos;
import {Card, CardText, CardMedia, CardTitle} from &apos;material-ui/Card&apos;
import Reviews, {AddReview} from &apos;./Reviews&apos;
import TechnicalRequirements from &apos;./TechnicalRequirements&apos;
import Concerts from &apos;./Concerts&apos;
import firebase from &apos;firebase&apos;
import {InfoSnippet, parseNumber, muiTheme, Icon} from &apos;../../utils&apos;
import cover from &apos;../../img/musician.jpg&apos;

/**
  * Band component
  */
export default class Band extends Component {
  /**
  * Band constructor
  */
  constructor() {
    super()

    /**
    * @type {Object} state
    * @property {Object} state.manager - Band&apos;s manager
    * @property {String} state.summary - Band&apos;s summary
    * @property {String} state.lastFMLink - Link to the band&apos;s LastFM profile
    */
    this.state = {
      manager: {},
      summary: &quot;&quot;,
      lastFMLink: &quot;&quot;,
      cover
    }
  }

  /**
  * Fetch band information from the database, and lastFM

  */
  componentDidMount() {
    const db = firebase.database().ref()
    const profilesRef = db.child(&apos;staff/profiles&apos;)
    const {band: {name, manager}} = this.props
    profilesRef.child(manager).on(&apos;value&apos;, snap =&gt; {
      this.setState({manager: snap.val()})
    })

    fetch(`https://ws.audioscrobbler.com/2.0/?method=artist.getinfo&amp;artist=${name}&amp;api_key=35f1b3f9790cddd48125c3b2acaae8a4&amp;format=json`)
    .then(response =&gt; {
      if (response.ok) {
        response.json().then(({artist}) =&gt; {
          let {
            bio: {summary},
            // image,
            // stats:{listeners}
          } = artist
          // bandKey &amp;&amp; firebase.database().ref(`bands/${bandKey}/monthlyListeners`).set(parseInt(listeners,10))
          const lastFMLink = summary.split(&apos;href=&quot;&apos;)[1].split(&apos;&quot;&gt;&apos;)[0]
          summary = summary.split(&apos;&lt;a&apos;)[0]
          // const cover = image[4][&quot;#text&quot;].replace(&quot;300x300&quot;, &quot;600x600&quot;)
          // cover !== &quot;&quot; &amp;&amp; this.setState({cover})
          this.setState({summary, lastFMLink})
      })}
    })
  }

  /**
  * Display a Band card
  * @return {JSX} Return a Band card
  */
  render() {
    let {
      headerType, title, subtitle,
      bandKey, band, concerts, reviewerName,
      showAlbumSales, showMonthlyListeners, showGenre, showManager,
      showBandMembers,
      showRequirements, canEditRequirements,
      showPreviousConcerts, showFutureConcerts,
      canAddReview, showReviews
    } = this.props

    const {
      manager: {name: managerName, email},
      cover, summary, lastFMLink
    } = this.state

    if (concerts) {
      concerts = Object.keys(concerts)
      .filter(concertKey =&gt; {
        const {band, isAcceptedByBookingBoss} = concerts[concertKey]
        return  band === bandKey &amp;&amp; isAcceptedByBookingBoss !== &quot;unhandled&quot;
      } )
      .reduce((filteredConcerts, concertKey) =&gt; {
        filteredConcerts[concertKey] = concerts[concertKey]
        return filteredConcerts
      }, {})
    }

    const {name, genre, albumSales, monthlyListeners, technicalRequirements, reviews, members} = band
    return (
      &lt;Card style={{margin: &quot;1em&quot;}}&gt;
        {{
          &quot;compact&quot;:
          &lt;CardTitle style={{paddingBottom: 8}} actAsExpander&gt;
            &lt;div style={{display: &quot;flex&quot;}}&gt;
              &lt;div style={{
                position: &quot;relative&quot;,
                width: 128,
                height: 128,
                overflow: &quot;hidden&quot;,
                backgroundColor: &quot;pink&quot;
              }}&gt;
                &lt;img
                  style={{
                    height: &quot;100%&quot;,
                    backgroundColor: &quot;grey&quot;,
                    filter: &quot;grayscale(1)&quot;
                  }}
                  src={cover}
                  alt={name}
                /&gt;
                &lt;div style={{
                  top: 0,
                  position: &quot;absolute&quot;,
                  width: &quot;100%&quot;,
                  height: &quot;100%&quot;,
                  zIndex: 1,
                  overflow: &quot;hidden&quot;,
                  backgroundImage: &quot;linear-gradient(to bottom, rgba(0,0,0,.4) 0%, rgba(229, 28, 40, 0.5) 100%)&quot;
                }}/&gt;
              &lt;/div&gt;
              &lt;div style={{flexGrow: 1}}&gt;
                &lt;h6 &gt;{title}&lt;/h6&gt;
                &lt;div style={{textAlign: &quot;center&quot;}}&gt;{subtitle}&lt;/div&gt;
              &lt;/div&gt;
              &lt;Icon color=&quot;black&quot; name=&quot;keyboard_arrow_down&quot;/&gt;
            &lt;/div&gt;
          &lt;/CardTitle&gt;,
          &quot;big&quot;: &lt;CardMedia
            className=&quot;band-cover&quot;
            overlayContentStyle={{
              background: &quot;linear-gradient(rgba(0,0,0,0), rgba(0,0,0,.6))&quot;
            }}
            actAsExpander
            overlay={
              &lt;CardTitle title={&lt;div style={{display: &quot;flex&quot;, justifyContent: &quot;space-between&quot;, alignItems: &quot;flex-end&quot;}}&gt;
                &lt;span&gt;{title}&lt;/span&gt;
                &lt;Icon color=&quot;white&quot; name=&quot;keyboard_arrow_down&quot;/&gt;
              &lt;/div&gt;} subtitle={subtitle}/&gt;
            }&gt;
            &lt;img style={{backgroundColor: &quot;grey&quot;}} src={cover} alt={name}/&gt;
          &lt;/CardMedia&gt;

        }[headerType]}

        &lt;CardText expandable&gt;
          {headerType === &quot;compact&quot; &amp;&amp; &lt;Divider/&gt;}
          &lt;Summary {...{summary, lastFMLink}}/&gt;
          &lt;List style={{display: &quot;flex&quot;, flexWrap: &quot;wrap&quot;}}&gt;
            &lt;AlbumSales {...{showAlbumSales, albumSales}}/&gt;
            &lt;Genre {...{showGenre, genre}}/&gt;
            &lt;MonthlyListeners {...{showMonthlyListeners, monthlyListeners}}/&gt;
            &lt;BandManager {...{showManager, email, managerName}}/&gt;
          &lt;/List&gt;
          &lt;BandMembers {...{showBandMembers, members}}/&gt;
          &lt;TechnicalRequirements {...{showRequirements, canEditRequirements, technicalRequirements, bandKey}}/&gt;
          &lt;Concerts {...{concerts, showPreviousConcerts, showFutureConcerts}}/&gt;
          &lt;AddReview {...{canAddReview, reviewerName, bandKey, concerts}}/&gt;
          &lt;Reviews {...{reviews, showReviews}}/&gt;
        &lt;/CardText&gt;
      &lt;/Card&gt;
    )
  }
}

/**
  * Display the band&apos;s manager
  * @param {Object} props
  * @param {Boolean} props.showManager - Should show the manager
  * @param {String} props.managerName - Name of the band&apos;s manager
  * @param {String} props.email - E-mail address of the band&apos;s manager
  * @return {JSX} Return the band&apos;s manager
  */
const BandManager = ({showManager, managerName, email}) =&gt; (
  &lt;div&gt;
    {showManager &amp;&amp;
      &lt;InfoSnippet
        disableHover
        icon=&quot;business&quot;
        subText=&quot;Band manager&quot;
      &gt;
        &lt;div style={{
            display: &quot;flex&quot;,
            alignItems: &quot;center&quot;
        }}&gt;
          &lt;div style={{fontSize: &quot;1.1em&quot;, margin: 0}}&gt;{managerName}&lt;/div&gt;
          &lt;FontIcon title={email} color={muiTheme.palette.accent1Color} style={{ marginLeft: &quot;.5em&quot;, cursor: &quot;pointer&quot;,fontSize: &quot;.9em&quot;}} className=&quot;material-icons&quot;&gt;mail&lt;/FontIcon&gt;
        &lt;/div&gt;
      &lt;/InfoSnippet&gt;
    }
  &lt;/div&gt;
)

/**
  * Display the band&apos;s summary
  * @param {Object} props
  * @param {String} props.summary - Summary of the band
  * @param {String} props.lastFM - Link to the band&apos;s LastFM profile
  * @return {JSX} Return the band&apos;s summary
  */
const Summary = ({summary, lastFMLink}) =&gt; (
  &lt;InfoSnippet
    orientation=&quot;portrait&quot;
    disableHover
    icon=&quot;info&quot;
    subText=&quot;Summary&quot;
    content={
      &lt;div&gt;
        &lt;p style={{textAlign: &quot;left&quot;}}&gt;{summary}&lt;/p&gt;
        &lt;a style={{fontSize: &quot;.8em&quot;, color: muiTheme.palette.accent1Color}} href={lastFMLink}&gt;more on Last.FM&lt;/a&gt;
      &lt;/div&gt;
    }
  /&gt;
)


/**
  * Display the band&apos;s album sales
  * @param {Object} props
  * @param {Boolean} props.showAlbumSales - Should show the album sales
  * @param {number} props.albumSales - Albums sold by the band
  * @return {JSX} Return the band&apos;s album sales
  */
const AlbumSales = ({showAlbumSales, albumSales}) =&gt; (
  &lt;div&gt;
    {showAlbumSales &amp;&amp;
      &lt;InfoSnippet
        icon=&quot;album&quot;
        subText=&quot;Album sales&quot;
        content={parseNumber(albumSales)}
      /&gt;}
  &lt;/div&gt;
)


/**
  * Display the band&apos;s genre
  * @param {Object} props
  * @param {Boolean} props.showGenre - Should show the genre
  * @param {String} props.genre - Genre of the band
  * @return {JSX} Return the band&apos;s genre
  */
const Genre = ({showGenre, genre}) =&gt; (
  &lt;div&gt;
    {showGenre &amp;&amp;
      &lt;InfoSnippet
        icon=&quot;fingerprint&quot;
        subText=&quot;Genre&quot;
        content={genre}
      /&gt;}
  &lt;/div&gt;
)


/**
  * Display the band&apos;s monthly listeners
  * @param {Object} props
  * @param {Boolean} props.showMonthlyListeners - Should show the monthly listeners
  * @param {number} props.monthlyListeners - Monthly listeners of the band
  * @return {JSX} Return the band&apos;s monthly listeners
  */
const MonthlyListeners = ({showMonthlyListeners, monthlyListeners}) =&gt; (
  &lt;div&gt;
    {showMonthlyListeners &amp;&amp;
      &lt;InfoSnippet
        icon=&quot;music_note&quot;
        subText=&quot;Monthly listeners&quot;
        content={parseNumber(monthlyListeners)}
      /&gt;}
  &lt;/div&gt;
)


/**
  * Display the band&apos;s members as a list
  * @param {Object} props
  * @param {Boolean} props.showBandMembers - Should show the band members
  * @param {Array} props.members - List of the members
  * @return {JSX} Return the band&apos;s members as a list
  */
const BandMembers = ({showBandMembers, members}) =&gt; (
  &lt;div&gt;
    {showBandMembers &amp;&amp;
      &lt;InfoSnippet
        disableHover
        disableTitle
        icon=&quot;people&quot;
        subText=&quot;Band members&quot;
      &gt;
        &lt;div style={{display: &quot;flex&quot;, flexWrap: &quot;wrap&quot;}}&gt;
          {members.map(member =&gt; &lt;Chip style={{margin: &quot;0 .6em .6em 0&quot;}} key={member}&gt;{member}&lt;/Chip&gt;)}
        &lt;/div&gt;
      &lt;/InfoSnippet&gt;
    }
  &lt;/div&gt;
)
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.0.4)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
